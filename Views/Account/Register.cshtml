@using DnTech_PBS_UniformManagement.ViewModels
@model RegisterViewModel
@{
    ViewData["Title"] = "Register";
}

<div class="auth-container">
    <div class="auth-card" style="max-width: 600px;">
        <!-- Logo/Icon -->
        <div class="auth-logo">
            <i class="fas fa-user-plus"></i>
        </div>

        <!-- Header -->
        <div class="auth-header">
            <h1 class="auth-title">Create Your Account</h1>
            <p class="auth-subtitle">Join us and start managing uniforms efficiently</p>
        </div>

        <!-- Success Message -->
        @if (TempData["Success"] != null)
        {
            <div class="alert alert-success" role="alert">
                <i class="fas fa-check-circle me-2"></i>
                @TempData["Success"]
            </div>
        }

        <!-- Validation Summary -->
        @if (!ViewData.ModelState.IsValid)
        {
            <div class="alert alert-danger" role="alert">
                <ul class="mb-0">
                    @foreach (var error in ViewData.ModelState.Values.SelectMany(v => v.Errors))
                    {
                        <li>@error.ErrorMessage</li>
                    }
                </ul>
            </div>
        }

        <!-- Register Form -->
        <form asp-action="Register" method="post" id="registerForm">
            <div class="row">
                <!-- Full Name -->
                <div class="col-md-12">
                    <div class="mb-3">
                        <label asp-for="Fullname" class="form-label">
                            <i class="fas fa-user me-2"></i>Full Name
                        </label>
                        <input asp-for="Fullname"
                               class="form-control"
                               placeholder="Enter your full name"
                               autocomplete="name" />
                        <span asp-validation-for="Fullname" class="text-danger"></span>
                    </div>
                </div>

                <!-- ID Card -->
                <div class="col-md-6">
                    <div class="mb-3">
                        <label asp-for="IdCard" class="form-label">
                            <i class="fas fa-id-card me-2"></i>ID Card (Optional)
                        </label>
                        <input asp-for="IdCard"
                               class="form-control"
                               placeholder="Enter ID card number" />
                        <span asp-validation-for="IdCard" class="text-danger"></span>
                    </div>
                </div>

                <!-- Email -->
                <div class="col-md-6">
                    <div class="mb-3">
                        <label asp-for="Email" class="form-label">
                            <i class="fas fa-envelope me-2"></i>Email
                        </label>
                        <input asp-for="Email"
                               class="form-control"
                               placeholder="Enter email address"
                               autocomplete="email"
                               type="email" />
                        <span asp-validation-for="Email" class="text-danger"></span>
                    </div>
                </div>

                <!-- Password -->
                <div class="col-md-6">
                    <div class="mb-3">
                        <label asp-for="Password" class="form-label">
                            <i class="fas fa-lock me-2"></i>Password
                        </label>
                        <div class="position-relative">
                            <input asp-for="Password"
                                   class="form-control pe-5"
                                   placeholder="Enter password"
                                   type="password"
                                   id="passwordField"
                                   autocomplete="new-password" />
                            <button type="button"
                                    class="btn btn-link position-absolute end-0 top-50 translate-middle-y text-decoration-none p-0 pe-3"
                                    onclick="togglePassword('passwordField', 'toggleIcon1')"
                                    tabindex="-1"
                                    style="z-index: 10; border: none; background: none;">
                                <i class="fas fa-eye" id="toggleIcon1" style="color: #94a3b8;"></i>
                            </button>
                        </div>
                        <span asp-validation-for="Password" class="text-danger"></span>
                    </div>
                </div>

                <!-- Confirm Password -->
                <div class="col-md-6">
                    <div class="mb-3">
                        <label asp-for="ConfirmPassword" class="form-label">
                            <i class="fas fa-check-circle me-2"></i>Confirm Password
                        </label>
                        <div class="position-relative">
                            <input asp-for="ConfirmPassword"
                                   class="form-control pe-5"
                                   placeholder="Confirm password"
                                   type="password"
                                   id="confirmPasswordField"
                                   autocomplete="new-password" />
                            <button type="button"
                                    class="btn btn-link position-absolute end-0 top-50 translate-middle-y text-decoration-none p-0 pe-3"
                                    onclick="togglePassword('confirmPasswordField', 'toggleIcon2')"
                                    tabindex="-1"
                                    style="z-index: 10; border: none; background: none;">
                                <i class="fas fa-eye" id="toggleIcon2" style="color: #94a3b8;"></i>
                            </button>
                        </div>
                        <span asp-validation-for="ConfirmPassword" class="text-danger"></span>
                    </div>
                </div>
            </div>

            <!-- Submit Button -->
            <div class="d-grid gap-2 mt-4">
                <button type="submit" class="btn btn-custom btn-gradient">
                    <i class="fas fa-user-plus me-2"></i>
                    Create Account
                </button>
            </div>

            <!-- Divider -->
            <div class="text-center my-4">
                <hr>
            </div>

            <!-- Login Link -->
            <div class="text-center">
                <p class="text-muted mb-0">
                    Already have an account?
                    <a asp-action="Login" class="text-decoration-none fw-bold" style="color: var(--primary-color);">
                        Sign in here
                    </a>
                </p>
            </div>
        </form>

        <!-- Password Requirements Info -->
        <div class="mt-4 p-3 rounded" style="background: #f1f5f9;">
            <h6 class="fw-bold mb-2" style="color: var(--primary-color);">
                <i class="fas fa-info-circle me-2"></i>Password Requirements:
            </h6>
            <ul class="small text-muted mb-0" style="list-style: none; padding-left: 0;">
                <li><i class="fas fa-check text-success me-2"></i>At least 6 characters long</li>
                <li><i class="fas fa-check text-success me-2"></i>Contains uppercase letter (A-Z)</li>
                <li><i class="fas fa-check text-success me-2"></i>Contains lowercase letter (a-z)</li>
                <li><i class="fas fa-check text-success me-2"></i>Contains a number (0-9)</li>
            </ul>
        </div>
    </div>
</div>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }

    <script>
        function togglePassword(fieldId, iconId) {
            const passwordField = document.getElementById(fieldId);
            const toggleIcon = document.getElementById(iconId);

            if (passwordField.type === 'password') {
                passwordField.type = 'text';
                toggleIcon.classList.remove('fa-eye');
                toggleIcon.classList.add('fa-eye-slash');
            } else {
                passwordField.type = 'password';
                toggleIcon.classList.remove('fa-eye-slash');
                toggleIcon.classList.add('fa-eye');
            }
        }

        document.getElementById('registerForm').addEventListener('submit', function(e) {
            const submitBtn = this.querySelector('button[type="submit"]');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Creating account...';
            submitBtn.disabled = true;

            setTimeout(function() {
                if (document.querySelectorAll('.field-validation-error').length > 0) {
                    submitBtn.innerHTML = originalText;
                    submitBtn.disabled = false;
                }
            }, 100);
        });

        const passwordField = document.getElementById('passwordField');
        const confirmPasswordField = document.getElementById('confirmPasswordField');

        if (confirmPasswordField) {
            confirmPasswordField.addEventListener('input', function() {
                if (this.value !== passwordField.value && this.value.length > 0) {
                    this.style.borderColor = '#ef4444';
                } else if (this.value === passwordField.value && this.value.length > 0) {
                    this.style.borderColor = '#10b981';
                } else {
                    this.style.borderColor = '#e2e8f0';
                }
            });
        }
    </script>
}









@* @using DnTech_PBS_UniformManagement.ViewModels
@model RegisterViewModel
@{
    ViewData["Title"] = "Register";
}

<div class="auth-container">
    <div class="auth-card" style="max-width: 600px;">
        <!-- Logo/Icon -->
        <div class="auth-logo">
            <i class="fas fa-user-plus"></i>
        </div>

        <!-- Header -->
        <div class="auth-header">
            <h1 class="auth-title">Create Account</h1>
            <p class="auth-subtitle">Fill in the information to register a new user</p>
        </div>

        <!-- Success Message -->
        @if (TempData["Success"] != null)
        {
            <div class="alert alert-success" role="alert">
                <i class="fas fa-check-circle me-2"></i>
                @TempData["Success"]
            </div>
        }

        <!-- Validation Summary -->
        @if (!ViewData.ModelState.IsValid)
        {
            <div class="alert alert-danger" role="alert">
                <ul class="mb-0">
                    @foreach (var error in ViewData.ModelState.Values.SelectMany(v => v.Errors))
                    {
                        <li>@error.ErrorMessage</li>
                    }
                </ul>
            </div>
        }

        <!-- Register Form -->
        <form asp-action="Register" method="post" id="registerForm">
            <div class="row">
                <!-- Full Name -->
                <div class="col-md-12">
                    <div class="mb-3">
                        <label asp-for="Fullname" class="form-label">
                            <i class="fas fa-user me-2"></i>Full Name
                        </label>
                        <input asp-for="Fullname"
                               class="form-control"
                               placeholder="Enter full name"
                               autocomplete="name" />
                        <span asp-validation-for="Fullname" class="text-danger"></span>
                    </div>
                </div>

                <!-- ID Card -->
                <div class="col-md-6">
                    <div class="mb-3">
                        <label asp-for="IdCard" class="form-label">
                            <i class="fas fa-id-card me-2"></i>ID Card (Optional)
                        </label>
                        <input asp-for="IdCard"
                               class="form-control"
                               placeholder="Enter ID card number" />
                        <span asp-validation-for="IdCard" class="text-danger"></span>
                    </div>
                </div>

                <!-- Email -->
                <div class="col-md-6">
                    <div class="mb-3">
                        <label asp-for="Email" class="form-label">
                            <i class="fas fa-envelope me-2"></i>Email
                        </label>
                        <input asp-for="Email"
                               class="form-control"
                               placeholder="Enter email address"
                               autocomplete="email"
                               type="email" />
                        <span asp-validation-for="Email" class="text-danger"></span>
                    </div>
                </div>

                <!-- Password -->
                <div class="col-md-6">
                    <div class="mb-3">
                        <label asp-for="Password" class="form-label">
                            <i class="fas fa-lock me-2"></i>Password
                        </label>
                        <div class="position-relative">
                            <input asp-for="Password"
                                   class="form-control pe-5"
                                   placeholder="Enter password"
                                   type="password"
                                   id="passwordField"
                                   autocomplete="new-password" />
                            <button type="button"
                                    class="btn btn-link position-absolute end-0 top-50 translate-middle-y text-decoration-none p-0 pe-3"
                                    onclick="togglePassword('passwordField', 'toggleIcon1')"
                                    tabindex="-1"
                                    style="z-index: 10; border: none; background: none;">
                                <i class="fas fa-eye" id="toggleIcon1" style="color: #94a3b8;"></i>
                            </button>
                        </div>
                        <span asp-validation-for="Password" class="text-danger"></span>
                        <small class="text-muted d-block mt-1">Minimum 6 characters, uppercase, lowercase, and digit</small>
                    </div>
                </div>

                <!-- Confirm Password -->
                <div class="col-md-6">
                    <div class="mb-3">
                        <label asp-for="ConfirmPassword" class="form-label">
                            <i class="fas fa-check-circle me-2"></i>Confirm Password
                        </label>
                        <div class="position-relative">
                            <input asp-for="ConfirmPassword"
                                   class="form-control pe-5"
                                   placeholder="Confirm password"
                                   type="password"
                                   id="confirmPasswordField"
                                   autocomplete="new-password" />
                            <button type="button"
                                    class="btn btn-link position-absolute end-0 top-50 translate-middle-y text-decoration-none p-0 pe-3"
                                    onclick="togglePassword('confirmPasswordField', 'toggleIcon2')"
                                    tabindex="-1"
                                    style="z-index: 10; border: none; background: none;">
                                <i class="fas fa-eye" id="toggleIcon2" style="color: #94a3b8;"></i>
                            </button>
                        </div>
                        <span asp-validation-for="ConfirmPassword" class="text-danger"></span>
                    </div>
                </div>

                <!-- Role Selection (Only for Administrators) -->
                @if (User.IsInRole("Administrator"))
                {
                    <div class="col-md-12">
                        <div class="mb-3">
                            <label asp-for="SelectedRole" class="form-label">
                                <i class="fas fa-user-tag me-2"></i>Role
                            </label>
                            <select asp-for="SelectedRole" class="form-control">
                                <option value="">-- Select a role --</option>
                                @if (ViewBag.Roles != null)
                                {
                                    @foreach (var role in ViewBag.Roles)
                                    {
                                        <option value="@role.Name">@role.Name</option>
                                    }
                                }
                            </select>
                            <span asp-validation-for="SelectedRole" class="text-danger"></span>
                        </div>
                    </div>
                }
            </div>

            <!-- Submit Buttons -->
            <div class="d-grid gap-2 mt-4">
                <button type="submit" class="btn btn-custom btn-gradient">
                    <i class="fas fa-user-plus me-2"></i>
                    Create Account
                </button>

                @if (User.IsInRole("Administrator"))
                {
                    <a asp-controller="Home" asp-action="Index" class="btn btn-outline-secondary">
                        <i class="fas fa-times me-2"></i>
                        Cancel
                    </a>
                }
            </div>

            <!-- Divider -->
            @if (!User.Identity.IsAuthenticated)
            {
                <div class="text-center my-4">
                    <hr>
                </div>

                <!-- Login Link -->
                <div class="text-center">
                    <p class="text-muted mb-0">
                        Already have an account?
                        <a asp-action="Login" class="text-decoration-none fw-bold" style="color: var(--primary-color);">
                            Sign in here
                        </a>
                    </p>
                </div>
            }
        </form>

        <!-- Password Requirements Info -->
        <div class="mt-4 p-3 rounded" style="background: #f1f5f9;">
            <h6 class="fw-bold mb-2" style="color: var(--primary-color);">
                <i class="fas fa-info-circle me-2"></i>Password Requirements:
            </h6>
            <ul class="small text-muted mb-0" style="list-style: none; padding-left: 0;">
                <li><i class="fas fa-check text-success me-2"></i>At least 6 characters long</li>
                <li><i class="fas fa-check text-success me-2"></i>Contains uppercase letter (A-Z)</li>
                <li><i class="fas fa-check text-success me-2"></i>Contains lowercase letter (a-z)</li>
                <li><i class="fas fa-check text-success me-2"></i>Contains a number (0-9)</li>
            </ul>
        </div>
    </div>
</div>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }

    <script>
        // Toggle password visibility
        function togglePassword(fieldId, iconId) {
            const passwordField = document.getElementById(fieldId);
            const toggleIcon = document.getElementById(iconId);

            if (passwordField.type === 'password') {
                passwordField.type = 'text';
                toggleIcon.classList.remove('fa-eye');
                toggleIcon.classList.add('fa-eye-slash');
            } else {
                passwordField.type = 'password';
                toggleIcon.classList.remove('fa-eye-slash');
                toggleIcon.classList.add('fa-eye');
            }
        }

        // Add loading state to button on submit
        document.getElementById('registerForm').addEventListener('submit', function(e) {
            const submitBtn = this.querySelector('button[type="submit"]');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Creating account...';
            submitBtn.disabled = true;

            // Si hay errores de validación en el cliente, revertir el botón
            setTimeout(function() {
                if (document.querySelectorAll('.field-validation-error').length > 0) {
                    submitBtn.innerHTML = originalText;
                    submitBtn.disabled = false;
                }
            }, 100);
        });

        // Real-time password validation feedback
        const passwordField = document.getElementById('passwordField');
        const confirmPasswordField = document.getElementById('confirmPasswordField');

        if (confirmPasswordField) {
            confirmPasswordField.addEventListener('input', function() {
                if (this.value !== passwordField.value && this.value.length > 0) {
                    this.classList.add('is-invalid');
                    this.style.borderColor = '#ef4444';
                } else if (this.value === passwordField.value && this.value.length > 0) {
                    this.classList.remove('is-invalid');
                    this.classList.add('is-valid');
                    this.style.borderColor = '#10b981';
                } else {
                    this.classList.remove('is-invalid', 'is-valid');
                    this.style.borderColor = '#e2e8f0';
                }
            });
        }
    </script>
} *@